import { useState, useEffect, useRef } from "react";
import { db } from "./firebase.js";
import { ref, set, get, onValue, runTransaction, remove } from "firebase/database";

// ============================================================
// IHCHS CLASS OF '92 ELECTION APP â€” QC-FIXED VERSION
// All bugs, security issues, and UX problems resolved
// ============================================================

// --- Utility: Generate a simple hash for vote integrity ---
const simpleHash = (str) => {
  let hash = 0;
  for (let i = 0; i < str.length; i++) {
    const char = str.charCodeAt(i);
    hash = ((hash << 5) - hash) + char;
    hash |= 0;
  }
  return Math.abs(hash).toString(36);
};

// --- Deep clone utility to avoid state mutation ---
const deepClone = (obj) => JSON.parse(JSON.stringify(obj));

// --- IHCHS School Crest (embedded PNG) ---
const IHCHS_LOGO = "data:image/png;base64,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";

// --- IHCHS Class of '92 Set Executive Election: Official Candidates ---
const DEFAULT_POSITIONS = [
  {
    id: "chairman",
    title: "Chairman",
    unopposed: true,
    candidates: [
      { id: "ch1", name: "Ronke Babs-Odunbanjo", motto: "" },
    ],
  },
  {
    id: "vice_chairman",
    title: "Vice Chairman",
    unopposed: true,
    candidates: [
      { id: "vc1", name: "Ken Nsofor", motto: "" },
    ],
  },
  {
    id: "vice_chairman_diaspora",
    title: "Vice Chairman â€” Diaspora",
    unopposed: true,
    candidates: [
      { id: "vcd1", name: "Omololu Shonuga", motto: "" },
    ],
  },
  {
    id: "secretary_general",
    title: "Secretary General",
    unopposed: false,
    candidates: [
      { id: "sg1", name: "Musibau Sunmola", motto: "" },
      { id: "sg2", name: "Rosary Ibe", motto: "" },
    ],
  },
  {
    id: "assistant_secretary",
    title: "Assistant Secretary",
    unopposed: true,
    candidates: [
      { id: "as1", name: "Maroof Adeyemo", motto: "" },
    ],
  },
  {
    id: "financial_secretary",
    title: "Financial Secretary",
    unopposed: true,
    candidates: [
      { id: "fs1", name: "Adetoun Adetola", motto: "" },
    ],
  },
  {
    id: "treasurer",
    title: "Treasurer",
    unopposed: true,
    candidates: [
      { id: "tr1", name: "Wale Ogunnowo", motto: "" },
    ],
  },
  {
    id: "legal_adviser",
    title: "Legal Adviser",
    unopposed: true,
    candidates: [
      { id: "la1", name: "Kunle Obebe", motto: "" },
    ],
  },
  {
    id: "socials_welfare",
    title: "Socials/Welfare Director",
    unopposed: false,
    candidates: [
      { id: "sw1", name: "Alfred Onu", motto: "" },
      { id: "sw2", name: "Kuburat Olushola", motto: "" },
    ],
  },
];

// --- Reusable Icon Components ---
const ShieldIcon = () => (
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
  </svg>
);

const VoteIcon = () => (
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="M20 6L9 17l-5-5"/>
  </svg>
);

const LockIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
    <path d="M7 11V7a5 5 0 0110 0v4"/>
  </svg>
);

const ChartIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/>
  </svg>
);

const UsersIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/>
  </svg>
);

const LogOutIcon = () => (
  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/>
  </svg>
);

const AlertIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
  </svg>
);

const SettingsIcon = () => (
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
  </svg>
);

const TrashIcon = () => (
  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
  </svg>
);

// ============================================================
// MAIN APP COMPONENT
// ============================================================
export default function ElectionApp() {
  // --- Core State ---
  const [screen, setScreen] = useState("loading");
  const [electionData, setElectionData] = useState(null);
  const [voterRegistry, setVoterRegistry] = useState([]);
  const [votes, setVotes] = useState({});
  const [votedCodes, setVotedCodes] = useState([]);
  const [currentVoter, setCurrentVoter] = useState(null);
  const [selections, setSelections] = useState({});
  const [error, setError] = useState("");
  const [loading, setLoading] = useState(false);
  const [adminKey, setAdminKey] = useState("");
  const [voterCode, setVoterCode] = useState("");
  const [bulkInput, setBulkInput] = useState("");
  const [electionActive, setElectionActive] = useState(false);
  const [currentStep, setCurrentStep] = useState(0);
  const [showConfirmDialog, setShowConfirmDialog] = useState(false);
  const [adminTab, setAdminTab] = useState("candidates");
  // FIX #5: Admin password stored in persistent storage (changeable)
  const [adminPassword, setAdminPassword] = useState("IHCHS92ADMIN");
  const [newAdminPassword, setNewAdminPassword] = useState("");
  // Brute-force protection â€” separate counters for admin and voter
  const [adminLoginAttempts, setAdminLoginAttempts] = useState(0);
  const [adminLockoutUntil, setAdminLockoutUntil] = useState(null);
  const [voterLoginAttempts, setVoterLoginAttempts] = useState(0);
  const [voterLockoutUntil, setVoterLockoutUntil] = useState(null);
  // FIX #11: Admin can control whether results are visible during voting
  const [resultsPublic, setResultsPublic] = useState(false);
  // FIX #12: Confirmation dialogs for critical actions (replacing confirm())
  const [showCloseConfirm, setShowCloseConfirm] = useState(false);
  const [showResetConfirm, setShowResetConfirm] = useState(false);
  const [showRemoveVoterConfirm, setShowRemoveVoterConfirm] = useState(null);
  // Connection status â€” Firebase requires internet
  const [connectionTimeout, setConnectionTimeout] = useState(false);

  // ============================================================
  // FIREBASE REAL-TIME DATA â€” Load & Sync Across All Devices
  // ============================================================
  // Unlike browser localStorage (which only lives on one device),
  // Firebase Realtime Database stores data in the cloud. When any
  // device writes data, ALL connected devices receive the update
  // instantly. This is what makes 400 alumni voting from different
  // locations possible â€” every vote is collected centrally.
  // ============================================================
  const initialLoadDone = useRef(false);
  const loadCounter = useRef(0);
  const TOTAL_LISTENERS = 7;

  useEffect(() => {
    // Each onValue listener fires immediately with current data, then
    // again whenever that data changes on the server (from any device).
    // We track when all 7 listeners have fired once to show the home screen.
    const markLoaded = () => {
      loadCounter.current++;
      if (!initialLoadDone.current && loadCounter.current >= TOTAL_LISTENERS) {
        initialLoadDone.current = true;
        setScreen("home");
      }
    };

    // Track all listener unsubscribe functions for cleanup
    const unsubs = [];

    // 1. Election configuration (positions & candidates)
    unsubs.push(onValue(ref(db, "election/config"), (snap) => {
      const data = snap.val();
      setElectionData(data || { positions: deepClone(DEFAULT_POSITIONS), title: "IHCHS Class of '92 Set Executive Election" });
      markLoaded();
    }));

    // 2. Voter registry
    unsubs.push(onValue(ref(db, "election/voters"), (snap) => {
      const data = snap.val();
      // Firebase stores arrays as objects with numeric keys â€” convert back to array
      setVoterRegistry(data ? (Array.isArray(data) ? data : Object.values(data)) : []);
      markLoaded();
    }));

    // 3. Vote tallies (the aggregated counts per position per candidate)
    unsubs.push(onValue(ref(db, "election/votes"), (snap) => {
      setVotes(snap.val() || {});
      markLoaded();
    }));

    // 4. Voted codes (which verification codes have been used)
    unsubs.push(onValue(ref(db, "election/votedCodes"), (snap) => {
      const data = snap.val();
      // Stored as { "0807890": true, "0901234": true } â€” convert to array of codes
      setVotedCodes(data ? Object.keys(data) : []);
      markLoaded();
    }));

    // 5. Election active status
    unsubs.push(onValue(ref(db, "election/meta/electionActive"), (snap) => {
      setElectionActive(snap.val() === true);
      markLoaded();
    }));

    // 6. Admin password
    unsubs.push(onValue(ref(db, "election/meta/adminPassword"), (snap) => {
      setAdminPassword(snap.val() || "IHCHS92ADMIN");
      markLoaded();
    }));

    // 7. Results visibility
    unsubs.push(onValue(ref(db, "election/meta/resultsPublic"), (snap) => {
      setResultsPublic(snap.val() === true);
      markLoaded();
    }));

    // Cleanup: detach all listeners when the component unmounts
    return () => unsubs.forEach(unsub => unsub());
  }, []);

  // Connection timeout: if Firebase hasn't loaded data within 12 seconds,
  // show a helpful error message instead of an infinite loading spinner
  useEffect(() => {
    const timer = setTimeout(() => {
      if (!initialLoadDone.current) {
        setConnectionTimeout(true);
      }
    }, 12000);
    return () => clearTimeout(timer);
  }, []);

  // ============================================================
  // FIREBASE WRITE HELPER
  // ============================================================
  // This function maps the app's internal storage keys to Firebase
  // database paths. All existing code that calls saveToStorage()
  // continues to work â€” it just writes to Firebase instead of the
  // browser's local storage.
  // ============================================================
  const saveToStorage = async (key, value) => {
    const pathMap = {
      "election-config": "election/config",
      "voter-registry": "election/voters",
      "election-votes": "election/votes",
      "voted-codes": "election/votedCodes",
      "election-active": "election/meta/electionActive",
      "admin-password": "election/meta/adminPassword",
      "results-public": "election/meta/resultsPublic",
    };
    const fbPath = pathMap[key];
    if (!fbPath) return;
    try {
      if (value === null || value === undefined) {
        // Null means delete this data from Firebase
        await remove(ref(db, fbPath));
      } else {
        await set(ref(db, fbPath), value);
      }
    } catch (err) {
      console.error(`Firebase write error (${key}):`, err);
    }
  };

  // ============================================================
  // NAVIGATION HELPER - FIX #9: Clears error on every screen change
  // ============================================================
  const navigateTo = (newScreen) => {
    setError("");
    setScreen(newScreen);
  };

  // ============================================================
  // ADMIN FUNCTIONS
  // ============================================================

  const handleAdminLogin = () => {
    // Brute-force lockout check (admin-specific)
    if (adminLockoutUntil && Date.now() < adminLockoutUntil) {
      const secsLeft = Math.ceil((adminLockoutUntil - Date.now()) / 1000);
      setError(`Too many failed attempts. Please wait ${secsLeft} seconds before trying again.`);
      return;
    }

    if (adminKey === adminPassword) {
      navigateTo("admin");
      setAdminKey("");
      setAdminLoginAttempts(0);
    } else {
      const newAttempts = adminLoginAttempts + 1;
      setAdminLoginAttempts(newAttempts);
      if (newAttempts >= 5) {
        setAdminLockoutUntil(Date.now() + 60000);
        setError("Too many failed attempts. Account locked for 60 seconds.");
      } else {
        setError(`Invalid admin password. ${5 - newAttempts} attempt(s) remaining.`);
      }
    }
  };

  // FIX #5: Allow admin to change password
  const handleChangePassword = async () => {
    if (newAdminPassword.length < 6) {
      setError("Password must be at least 6 characters.");
      return;
    }
    setAdminPassword(newAdminPassword);
    await saveToStorage("admin-password", newAdminPassword);
    setNewAdminPassword("");
    setError("âœ“ Admin password changed successfully!");
  };

  // FIX #1 (CRITICAL): Improved phone number parser that handles hyphens, spaces, brackets
  const handleBulkAddVoters = async () => {
    const lines = bulkInput.trim().split("\n").filter(l => l.trim());
    const newRegistry = [...voterRegistry];
    let added = 0;
    let skipped = 0;
    let invalid = 0;
    const duplicateDetails = [];

    lines.forEach(line => {
      // Require whitespace BEFORE separator to avoid splitting hyphenated names
      // e.g. "Babs-Odunbanjo Ronke - 09011112222" correctly keeps full name
      // Supports: "Name - Phone", "Name â€“ Phone", "Name | Phone", "Name, Phone"
      const separatorMatch = line.match(/^(.+?)(?:\s+[-â€“|]\s*|\s*,\s+)(.+)$/);
      let name = "", rawPhone = "";

      if (separatorMatch) {
        name = separatorMatch[1].trim();
        rawPhone = separatorMatch[2].trim();
      } else {
        rawPhone = line.trim();
      }

      // Strip ALL non-digit characters from the phone number
      const phone = rawPhone.replace(/\D/g, "");

      // Validate: Nigerian numbers should be 11 digits (0xxx...) or 13 digits (234xxx...)
      if (phone.length >= 7) {
        const code = phone.slice(0, 3) + phone.slice(-4);
        if (!name) {
          name = `Voter_${code}`;
        }

        // FIX #16: Check for duplicates and provide detailed feedback
        const existingVoter = newRegistry.find(v => v.code === code);
        if (existingVoter) {
          skipped++;
          duplicateDetails.push(`"${name}" has the same code (${code}) as "${existingVoter.name}"`);
        } else {
          // Mask the middle digits for privacy display
          const maskedPhone = phone.length >= 8
            ? phone.slice(0, 4) + "****" + phone.slice(-4)
            : phone;
          newRegistry.push({
            name,
            phone: maskedPhone,
            code,
            addedAt: new Date().toISOString()
          });
          added++;
        }
      } else {
        invalid++;
      }
    });

    setVoterRegistry(newRegistry);
    await saveToStorage("voter-registry", newRegistry);
    setBulkInput("");

    let msg = `âœ“ ${added} voter(s) added successfully.`;
    if (skipped > 0) msg += ` ${skipped} duplicate(s) skipped.`;
    if (invalid > 0) msg += ` ${invalid} invalid number(s) ignored.`;
    if (duplicateDetails.length > 0) {
      msg += ` Duplicates: ${duplicateDetails.join("; ")}`;
    }
    setError(msg);
  };

  // FIX #13: Remove individual voter
  const removeVoter = async (index) => {
    const updated = [...voterRegistry];
    updated.splice(index, 1);
    setVoterRegistry(updated);
    await saveToStorage("voter-registry", updated);
    setShowRemoveVoterConfirm(null);
    setError("âœ“ Voter removed successfully.");
  };

  // FIX #2 (CRITICAL): Deep clone state before mutation
  const updateCandidate = (posIdx, candIdx, field, value) => {
    const updated = deepClone(electionData);
    updated.positions[posIdx].candidates[candIdx][field] = value;
    setElectionData(updated);
  };

  const addCandidate = (posIdx) => {
    const updated = deepClone(electionData);
    const pos = updated.positions[posIdx];
    const newId = `${pos.id}_c${Date.now()}`;
    pos.candidates.push({ id: newId, name: "", motto: "" });
    setElectionData(updated);
  };

  const removeCandidate = (posIdx, candIdx) => {
    const updated = deepClone(electionData);
    // Allow removal down to 1 candidate (needed for unopposed positions)
    if (updated.positions[posIdx].candidates.length > 1) {
      updated.positions[posIdx].candidates.splice(candIdx, 1);
      setElectionData(updated);
    }
  };

  const addPosition = () => {
    const updated = deepClone(electionData);
    const newId = `position_${Date.now()}`;
    updated.positions.push({
      id: newId,
      title: "New Position",
      candidates: [
        { id: `${newId}_c1`, name: "", motto: "" },
        { id: `${newId}_c2`, name: "", motto: "" },
      ],
    });
    setElectionData(updated);
  };

  // FIX #14: Remove position
  const removePosition = (posIdx) => {
    const updated = deepClone(electionData);
    if (updated.positions.length > 1) {
      updated.positions.splice(posIdx, 1);
      setElectionData(updated);
    }
  };

  const saveElectionConfig = async () => {
    await saveToStorage("election-config", electionData);
    setError("âœ“ Election configuration saved successfully!");
  };

  // FIX #15: Validate before opening election
  const toggleElection = async () => {
    if (!electionActive) {
      // Validations before opening
      const emptyNames = electionData?.positions?.some(p =>
        p.candidates.some(c => !c.name.trim())
      );
      if (emptyNames) {
        setError("Cannot open election: Some candidates have empty names. Please fill in all candidate names first.");
        return;
      }
      if (voterRegistry.length === 0) {
        setError("Cannot open election: No voters registered. Please add voters first.");
        return;
      }
      // Save config before opening
      await saveToStorage("election-config", electionData);
      setElectionActive(true);
      await saveToStorage("election-active", true);
      setError("âœ“ Election is now OPEN. Voters can cast their ballots.");
    } else {
      // FIX #12: Show confirmation before closing
      setShowCloseConfirm(true);
    }
  };

  const confirmCloseElection = async () => {
    setElectionActive(false);
    await saveToStorage("election-active", false);
    setShowCloseConfirm(false);
    setError("âœ“ Election is now CLOSED. No further votes can be cast.");
  };

  // FIX #11: Toggle results visibility
  const toggleResultsVisibility = async () => {
    const newState = !resultsPublic;
    setResultsPublic(newState);
    await saveToStorage("results-public", newState);
  };

  // FIX #3: Replace confirm() with in-app confirmation dialog
  const resetElection = async () => {
    setVotes({});
    setVotedCodes([]);
    setVoterRegistry([]);
    setElectionActive(false);
    setResultsPublic(false);
    setElectionData({ positions: deepClone(DEFAULT_POSITIONS), title: "IHCHS Class of '92 Set Executive Election" });
    // Clear all Firebase data â€” use remove() for paths that store collections
    await remove(ref(db, "election/votes"));
    await remove(ref(db, "election/votedCodes"));
    await remove(ref(db, "election/voters"));
    await set(ref(db, "election/meta/electionActive"), false);
    await set(ref(db, "election/meta/resultsPublic"), false);
    await remove(ref(db, "election/config"));
    setShowResetConfirm(false);
    setError("âœ“ Election has been completely reset.");
  };

  // ============================================================
  // VOTER FUNCTIONS
  // ============================================================
  const handleVoterLogin = () => {
    setError("");
    const code = voterCode.trim();

    // Brute-force protection (voter-specific, separate from admin)
    if (voterLockoutUntil && Date.now() < voterLockoutUntil) {
      const secsLeft = Math.ceil((voterLockoutUntil - Date.now()) / 1000);
      setError(`Too many failed attempts. Please wait ${secsLeft} seconds.`);
      return;
    }

    if (!electionActive) {
      setError("The election is not currently active. Please check back later.");
      return;
    }

    if (!code || code.length < 7) {
      setError("Please enter a valid 7-digit verification code.");
      return;
    }

    const voter = voterRegistry.find(v => v.code === code);
    if (!voter) {
      const newAttempts = voterLoginAttempts + 1;
      setVoterLoginAttempts(newAttempts);
      if (newAttempts >= 5) {
        setVoterLockoutUntil(Date.now() + 60000);
        setError("Too many failed attempts. Please wait 60 seconds before trying again.");
      } else {
        setError(`Invalid verification code. Your code is the first 3 digits and last 4 digits of your registered phone number. (${5 - newAttempts} attempt(s) remaining)`);
      }
      return;
    }

    if (votedCodes.includes(code)) {
      setCurrentVoter(voter);
      navigateTo("already_voted");
      return;
    }

    setCurrentVoter(voter);
    setSelections({});
    setCurrentStep(0);
    setVoterLoginAttempts(0);
    navigateTo("ballot");
  };

  const castVote = async () => {
    setLoading(true);

    try {
      // ATOMIC VOTE COUNTING using Firebase transactions.
      // When two alumni press "Submit" at the exact same second, both
      // votes are guaranteed to be counted correctly. Firebase transactions
      // read the current count, increment it, and write it back atomically â€”
      // if another write happened in between, the transaction retries
      // automatically until it succeeds.
      for (const [positionId, candidateId] of Object.entries(selections)) {
        // "abstain" means the voter chose not to vote on this position
        if (candidateId === "abstain") continue;

        // "reject" is the NO vote for unopposed candidates â€” stored as __reject
        const voteKey = candidateId === "reject" ? "__reject" : candidateId;
        const tallyRef = ref(db, `election/votes/${positionId}/${voteKey}`);

        // Atomically increment: read current count â†’ add 1 â†’ write back
        await runTransaction(tallyRef, (currentCount) => {
          return (currentCount || 0) + 1;
        });
      }

      // Mark this voter's code as used in Firebase.
      // Stored as election/votedCodes/0807890: true
      // This prevents the same code from being used twice.
      await set(ref(db, `election/votedCodes/${currentVoter.code}`), true);

      // The React state (votes, votedCodes) will update automatically
      // through the onValue listeners we set up â€” no need to manually
      // update local state here. Every device sees the new totals instantly.
    } catch (err) {
      console.error("Vote submission error:", err);
      setError("Error submitting vote. Please check your internet connection and try again.");
      setLoading(false);
      return;
    }

    setLoading(false);
    navigateTo("confirmation");
  };

  // ============================================================
  // RENDER HELPERS
  // ============================================================
  const totalVotesCast = votedCodes.length;
  const totalRegistered = voterRegistry.length;

  const getVoteCount = (positionId, candidateId) => {
    return votes[positionId]?.[candidateId] || 0;
  };

  const getPositionTotalVotes = (positionId) => {
    const posVotes = votes[positionId] || {};
    return Object.values(posVotes).reduce((sum, count) => sum + count, 0);
  };

  // ============================================================
  // STYLES
  // ============================================================
  const styles = {
    app: {
      minHeight: "100vh",
      background: "linear-gradient(135deg, #0a1628 0%, #1a2744 40%, #0d2137 100%)",
      fontFamily: "'Georgia', 'Times New Roman', serif",
      color: "#e8edf3",
    },
    header: {
      background: "linear-gradient(180deg, rgba(10, 22, 40, 0.95) 0%, rgba(10, 22, 40, 0.7) 100%)",
      borderBottom: "2px solid #c9a84c",
      padding: "16px 20px",
      textAlign: "center",
      backdropFilter: "blur(10px)",
      position: "sticky",
      top: 0,
      zIndex: 100,
    },
    headerTitle: {
      fontSize: "18px",
      fontWeight: "700",
      color: "#c9a84c",
      letterSpacing: "2px",
      textTransform: "uppercase",
      margin: 0,
    },
    headerSub: {
      fontSize: "11px",
      color: "#8899aa",
      letterSpacing: "3px",
      textTransform: "uppercase",
      marginTop: "4px",
    },
    container: {
      maxWidth: "520px",
      margin: "0 auto",
      padding: "24px 16px",
    },
    card: {
      background: "rgba(255,255,255,0.04)",
      border: "1px solid rgba(201, 168, 76, 0.15)",
      borderRadius: "12px",
      padding: "28px 24px",
      marginBottom: "16px",
      backdropFilter: "blur(5px)",
    },
    cardHighlight: {
      background: "linear-gradient(135deg, rgba(201, 168, 76, 0.08) 0%, rgba(201, 168, 76, 0.02) 100%)",
      border: "1px solid rgba(201, 168, 76, 0.3)",
      borderRadius: "12px",
      padding: "28px 24px",
      marginBottom: "16px",
    },
    btn: {
      width: "100%",
      padding: "14px 24px",
      borderRadius: "8px",
      border: "none",
      cursor: "pointer",
      fontSize: "15px",
      fontWeight: "600",
      fontFamily: "'Georgia', serif",
      letterSpacing: "1px",
      transition: "all 0.2s ease",
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      gap: "8px",
    },
    btnPrimary: {
      background: "linear-gradient(135deg, #c9a84c 0%, #a8872e 100%)",
      color: "#0a1628",
    },
    btnSecondary: {
      background: "rgba(255,255,255,0.06)",
      color: "#c9a84c",
      border: "1px solid rgba(201, 168, 76, 0.3)",
    },
    btnDanger: {
      background: "rgba(220, 50, 50, 0.15)",
      color: "#ef6b6b",
      border: "1px solid rgba(220, 50, 50, 0.3)",
    },
    btnSuccess: {
      background: "linear-gradient(135deg, #2d7a4f 0%, #1d5c38 100%)",
      color: "#ffffff",
    },
    input: {
      width: "100%",
      padding: "14px 16px",
      borderRadius: "8px",
      border: "1px solid rgba(201, 168, 76, 0.25)",
      background: "rgba(0,0,0,0.3)",
      color: "#e8edf3",
      fontSize: "16px",
      fontFamily: "'Georgia', serif",
      outline: "none",
      boxSizing: "border-box",
      transition: "border-color 0.2s",
    },
    textarea: {
      width: "100%",
      padding: "14px 16px",
      borderRadius: "8px",
      border: "1px solid rgba(201, 168, 76, 0.25)",
      background: "rgba(0,0,0,0.3)",
      color: "#e8edf3",
      fontSize: "14px",
      fontFamily: "monospace",
      outline: "none",
      boxSizing: "border-box",
      minHeight: "140px",
      resize: "vertical",
    },
    label: {
      fontSize: "12px",
      color: "#8899aa",
      textTransform: "uppercase",
      letterSpacing: "1.5px",
      marginBottom: "6px",
      display: "block",
    },
    error: {
      background: "rgba(220, 50, 50, 0.1)",
      border: "1px solid rgba(220, 50, 50, 0.3)",
      color: "#ef6b6b",
      padding: "12px 16px",
      borderRadius: "8px",
      fontSize: "13px",
      marginBottom: "16px",
      display: "flex",
      alignItems: "flex-start",
      gap: "8px",
    },
    success: {
      background: "rgba(45, 122, 79, 0.15)",
      border: "1px solid rgba(45, 122, 79, 0.3)",
      color: "#6bcf8e",
      padding: "12px 16px",
      borderRadius: "8px",
      fontSize: "13px",
      marginBottom: "16px",
    },
    badge: {
      display: "inline-block",
      padding: "4px 10px",
      borderRadius: "20px",
      fontSize: "11px",
      fontWeight: "700",
      letterSpacing: "1px",
      textTransform: "uppercase",
    },
    candidateOption: (selected) => ({
      background: selected
        ? "linear-gradient(135deg, rgba(201, 168, 76, 0.15) 0%, rgba(201, 168, 76, 0.05) 100%)"
        : "rgba(255,255,255,0.02)",
      border: selected
        ? "2px solid #c9a84c"
        : "1px solid rgba(255,255,255,0.08)",
      borderRadius: "10px",
      padding: "16px 18px",
      cursor: "pointer",
      transition: "all 0.2s ease",
      display: "flex",
      alignItems: "center",
      gap: "12px",
      marginBottom: "8px",
    }),
    abstainOption: (selected) => ({
      background: selected
        ? "rgba(255,255,255,0.08)"
        : "rgba(255,255,255,0.01)",
      border: selected
        ? "2px solid #6b7d8e"
        : "1px dashed rgba(255,255,255,0.1)",
      borderRadius: "10px",
      padding: "12px 18px",
      cursor: "pointer",
      transition: "all 0.2s ease",
      display: "flex",
      alignItems: "center",
      gap: "12px",
      marginBottom: "8px",
    }),
    radio: (selected) => ({
      width: "22px",
      height: "22px",
      borderRadius: "50%",
      border: selected ? "2px solid #c9a84c" : "2px solid rgba(255,255,255,0.2)",
      background: selected ? "#c9a84c" : "transparent",
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      flexShrink: 0,
      transition: "all 0.2s",
    }),
    progressBar: {
      height: "6px",
      borderRadius: "3px",
      background: "rgba(255,255,255,0.06)",
      overflow: "hidden",
      marginBottom: "20px",
    },
    progressFill: (pct) => ({
      height: "100%",
      width: `${pct}%`,
      background: "linear-gradient(90deg, #c9a84c, #e8c95a)",
      borderRadius: "3px",
      transition: "width 0.4s ease",
    }),
    resultBar: () => ({
      height: "28px",
      borderRadius: "6px",
      background: "rgba(255,255,255,0.06)",
      overflow: "hidden",
      position: "relative",
      marginTop: "6px",
    }),
    resultFill: (pct, isLeading) => ({
      height: "100%",
      width: `${Math.max(pct, 2)}%`,
      background: isLeading
        ? "linear-gradient(90deg, #c9a84c, #e8c95a)"
        : "linear-gradient(90deg, rgba(255,255,255,0.15), rgba(255,255,255,0.08))",
      borderRadius: "6px",
      transition: "width 0.6s ease",
      display: "flex",
      alignItems: "center",
      paddingLeft: "10px",
    }),
    divider: {
      height: "1px",
      background: "rgba(201, 168, 76, 0.15)",
      margin: "20px 0",
    },
    tab: (active) => ({
      padding: "10px 16px",
      borderRadius: "6px",
      border: "none",
      cursor: "pointer",
      fontSize: "12px",
      fontWeight: "600",
      letterSpacing: "1px",
      textTransform: "uppercase",
      fontFamily: "'Georgia', serif",
      background: active ? "rgba(201, 168, 76, 0.15)" : "transparent",
      color: active ? "#c9a84c" : "#6b7d8e",
      transition: "all 0.2s",
    }),
    // Reusable inline confirm dialog
    confirmOverlay: {
      background: "rgba(0,0,0,0.5)",
      border: "2px solid #c9a84c",
      borderRadius: "12px",
      padding: "24px",
      textAlign: "center",
      marginBottom: "16px",
    },
  };

  // --- Reusable error/success banner component ---
  const StatusBanner = () => {
    if (!error) return null;
    return (
      <div style={error.startsWith("âœ“") ? styles.success : styles.error}>
        {!error.startsWith("âœ“") && <AlertIcon />}
        <span style={{ flex: 1 }}>{error}</span>
        <button
          onClick={() => setError("")}
          style={{ background: "none", border: "none", color: "inherit", cursor: "pointer", fontSize: "16px", padding: "0 0 0 8px", lineHeight: 1 }}
        >âœ•</button>
      </div>
    );
  };

  // ============================================================
  // SCREEN: LOADING
  // ============================================================
  if (screen === "loading") {
    return (
      <div style={{ ...styles.app, display: "flex", alignItems: "center", justifyContent: "center" }}>
        <div style={{ textAlign: "center", padding: "0 24px" }}>
          <div style={{ fontSize: "32px", color: "#c9a84c", marginBottom: "12px" }}>
            <img src={IHCHS_LOGO} alt="IHCHS Crest" style={{ width: "64px", height: "64px", objectFit: "contain" }} />
          </div>
          {connectionTimeout ? (
            <>
              <p style={{ color: "#ef6b6b", fontSize: "14px", marginBottom: "12px", fontWeight: "600" }}>
                Unable to connect to the election server
              </p>
              <p style={{ color: "#8899aa", fontSize: "12px", lineHeight: 1.6, marginBottom: "20px" }}>
                Please check your internet connection and try again. This app requires an active internet connection to load election data.
              </p>
              <button
                onClick={() => window.location.reload()}
                style={{ ...styles.btn, maxWidth: "200px", margin: "0 auto" }}
              >
                Retry Connection
              </button>
            </>
          ) : (
            <p style={{ color: "#8899aa", letterSpacing: "2px", fontSize: "12px", textTransform: "uppercase" }}>
              Connecting to Election Server...
            </p>
          )}
        </div>
      </div>
    );
  }

  // ============================================================
  // SCREEN: HOME
  // ============================================================
  if (screen === "home") {
    return (
      <div style={styles.app}>
        <div style={styles.header}>
          <h1 style={styles.headerTitle}>IHCHS Class of '92</h1>
          <p style={styles.headerSub}>Alumni Set Executive Election</p>
        </div>
        <div style={styles.container}>
          <div style={{ textAlign: "center", padding: "36px 0 28px" }}>
            <div style={{
              width: "100px", height: "100px", borderRadius: "16px",
              background: "linear-gradient(135deg, rgba(201, 168, 76, 0.15), rgba(201, 168, 76, 0.03))",
              border: "2px solid rgba(201, 168, 76, 0.25)",
              display: "flex", alignItems: "center", justifyContent: "center",
              margin: "0 auto 20px", overflow: "hidden",
            }}>
              <img src={IHCHS_LOGO} alt="IHCHS Crest" style={{ width: "88px", height: "88px", objectFit: "contain" }} />
            </div>
            <h2 style={{ fontSize: "22px", color: "#e8edf3", margin: "0 0 8px", fontWeight: "700" }}>
              {electionData?.title || "Alumni Election"}
            </h2>
            <p style={{ fontSize: "13px", color: "#6b7d8e", margin: 0, lineHeight: 1.6 }}>
              Secured Electronic Voting System
            </p>
            <div style={{ marginTop: "16px" }}>
              <span style={{
                ...styles.badge,
                background: electionActive ? "rgba(45, 122, 79, 0.2)" : "rgba(220, 50, 50, 0.15)",
                color: electionActive ? "#6bcf8e" : "#ef6b6b",
                border: `1px solid ${electionActive ? "rgba(45, 122, 79, 0.3)" : "rgba(220, 50, 50, 0.3)"}`,
              }}>
                {electionActive ? "â— Election Open" : "â— Election Not Active"}
              </span>
            </div>
          </div>

          <div style={{
            display: "flex", justifyContent: "center", gap: "32px",
            marginBottom: "28px", padding: "16px 0",
            borderTop: "1px solid rgba(201, 168, 76, 0.1)",
            borderBottom: "1px solid rgba(201, 168, 76, 0.1)",
          }}>
            <div style={{ textAlign: "center" }}>
              <div style={{ fontSize: "24px", fontWeight: "700", color: "#c9a84c" }}>{totalRegistered}</div>
              <div style={{ fontSize: "10px", color: "#6b7d8e", textTransform: "uppercase", letterSpacing: "1px" }}>Registered</div>
            </div>
            <div style={{ textAlign: "center" }}>
              <div style={{ fontSize: "24px", fontWeight: "700", color: "#c9a84c" }}>{totalVotesCast}</div>
              <div style={{ fontSize: "10px", color: "#6b7d8e", textTransform: "uppercase", letterSpacing: "1px" }}>Votes Cast</div>
            </div>
            <div style={{ textAlign: "center" }}>
              <div style={{ fontSize: "24px", fontWeight: "700", color: "#c9a84c" }}>{electionData?.positions?.length || 0}</div>
              <div style={{ fontSize: "10px", color: "#6b7d8e", textTransform: "uppercase", letterSpacing: "1px" }}>Positions</div>
            </div>
          </div>

          <button
            style={{ ...styles.btn, ...styles.btnPrimary, marginBottom: "12px" }}
            onClick={() => { navigateTo("voter_login"); setVoterCode(""); }}
          >
            <VoteIcon /> CAST YOUR VOTE
          </button>

          {/* FIX #11: Results button only shows if results are public OR election is closed */}
          <button
            style={{ ...styles.btn, ...styles.btnSecondary, marginBottom: "12px", opacity: (resultsPublic || !electionActive) ? 1 : 0.4 }}
            onClick={() => {
              if (resultsPublic || !electionActive) {
                navigateTo("results");
              } else {
                setError("Results will be available after the election closes or when the Electoral Commission publishes them.");
              }
            }}
          >
            <ChartIcon /> VIEW RESULTS
          </button>

          <button
            style={{ ...styles.btn, ...styles.btnSecondary, opacity: 0.7 }}
            onClick={() => { navigateTo("admin_login"); setAdminKey(""); }}
          >
            <SettingsIcon /> ADMIN / ELECTORAL COMMISSION
          </button>

          <StatusBanner />
        </div>
      </div>
    );
  }

  // ============================================================
  // SCREEN: ADMIN LOGIN
  // ============================================================
  if (screen === "admin_login") {
    return (
      <div style={styles.app}>
        <div style={styles.header}>
          <h1 style={styles.headerTitle}>Admin Access</h1>
          <p style={styles.headerSub}>Electoral Commission Only</p>
        </div>
        <div style={styles.container}>
          <div style={styles.card}>
            <div style={{ textAlign: "center", marginBottom: "24px" }}>
              <div style={{ color: "#c9a84c", marginBottom: "12px" }}><LockIcon /></div>
              <p style={{ fontSize: "13px", color: "#8899aa", margin: 0 }}>
                Enter the admin password to manage the election.
              </p>
            </div>

            <StatusBanner />

            <div style={{ marginBottom: "16px" }}>
              <label style={styles.label}>Admin Password</label>
              <input
                type="password"
                style={styles.input}
                value={adminKey}
                onChange={e => setAdminKey(e.target.value)}
                onKeyDown={e => e.key === "Enter" && handleAdminLogin()}
                placeholder="Enter admin password"
              />
            </div>

            <button style={{ ...styles.btn, ...styles.btnPrimary }} onClick={handleAdminLogin}>
              <LockIcon /> Access Admin Panel
            </button>

            <div style={styles.divider} />

            <button
              style={{ ...styles.btn, ...styles.btnSecondary }}
              onClick={() => navigateTo("home")}
            >
              â† Back to Home
            </button>
          </div>
        </div>
      </div>
    );
  }

  // ============================================================
  // SCREEN: ADMIN PANEL
  // ============================================================
  if (screen === "admin") {
    return (
      <div style={styles.app}>
        <div style={styles.header}>
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
            <div>
              <h1 style={{ ...styles.headerTitle, fontSize: "14px" }}>Admin Panel</h1>
              <p style={{ ...styles.headerSub, marginTop: "2px" }}>Electoral Commission</p>
            </div>
            <button
              style={{ background: "none", border: "none", color: "#8899aa", cursor: "pointer", display: "flex", alignItems: "center", gap: "4px", fontSize: "11px", fontFamily: "'Georgia', serif" }}
              onClick={() => navigateTo("home")}
            >
              <LogOutIcon /> Exit
            </button>
          </div>
        </div>
        <div style={styles.container}>
          {/* FIX #9: Tabs clear error when switching */}
          <div style={{ display: "flex", gap: "4px", marginBottom: "20px", overflowX: "auto", paddingBottom: "4px" }}>
            {[
              { key: "candidates", label: "Candidates" },
              { key: "voters", label: "Voters" },
              { key: "control", label: "Control" },
            ].map(tab => (
              <button key={tab.key} style={styles.tab(adminTab === tab.key)} onClick={() => { setAdminTab(tab.key); setError(""); }}>
                {tab.label}
              </button>
            ))}
          </div>

          <StatusBanner />

          {/* --- CANDIDATES TAB --- */}
          {adminTab === "candidates" && (
            <>
              {/* QC2-4: Warning + lock when election is active */}
              {electionActive ? (
                <div style={{
                  ...styles.card,
                  borderColor: "rgba(220, 50, 50, 0.3)",
                  textAlign: "center",
                  padding: "32px 24px",
                }}>
                  <div style={{ color: "#ef6b6b", marginBottom: "12px" }}><AlertIcon /></div>
                  <h3 style={{ fontSize: "16px", color: "#ef6b6b", margin: "0 0 8px" }}>Editing Locked</h3>
                  <p style={{ fontSize: "13px", color: "#8899aa", margin: "0 0 4px", lineHeight: 1.6 }}>
                    Candidates cannot be edited while the election is active. Changing candidates during voting would invalidate ballots already cast.
                  </p>
                  <p style={{ fontSize: "12px", color: "#6b7d8e", margin: "12px 0 0" }}>
                    Close the election first in the <strong style={{ color: "#c9a84c", cursor: "pointer" }} onClick={() => setAdminTab("control")}>Control</strong> tab to make changes.
                  </p>
                </div>
              ) : (
              <>
              <p style={{ fontSize: "13px", color: "#8899aa", marginBottom: "20px" }}>
                Edit the positions and candidate names for the election. Click "Save Configuration" when done.
              </p>

              {electionData?.positions?.map((pos, posIdx) => (
                <div key={pos.id} style={{ ...styles.card, padding: "20px", position: "relative" }}>
                  {/* FIX #14: Remove position button */}
                  {electionData.positions.length > 1 && (
                    <button
                      onClick={() => removePosition(posIdx)}
                      style={{ position: "absolute", top: "10px", right: "10px", background: "rgba(220,50,50,0.1)", border: "none", color: "#ef6b6b", borderRadius: "4px", padding: "4px 8px", cursor: "pointer", fontSize: "10px", fontFamily: "'Georgia', serif" }}
                    >Remove Position</button>
                  )}
                  <input
                    style={{ ...styles.input, fontWeight: "700", fontSize: "15px", marginBottom: "12px", background: "transparent", border: "none", borderBottom: "1px solid rgba(201, 168, 76, 0.2)", borderRadius: 0, padding: "8px 0", color: "#c9a84c", paddingRight: "110px" }}
                    value={pos.title}
                    onChange={e => {
                      const updated = deepClone(electionData);
                      updated.positions[posIdx].title = e.target.value;
                      setElectionData(updated);
                    }}
                  />
                  {pos.candidates.map((cand, candIdx) => (
                    <div key={cand.id} style={{ display: "flex", gap: "8px", marginBottom: "8px", alignItems: "center" }}>
                      <input
                        style={{ ...styles.input, flex: 1, fontSize: "13px", padding: "10px 12px" }}
                        value={cand.name}
                        onChange={e => updateCandidate(posIdx, candIdx, "name", e.target.value)}
                        placeholder={`Candidate ${candIdx + 1} name`}
                      />
                      {pos.candidates.length > 1 && (
                        <button
                          style={{ background: "rgba(220,50,50,0.15)", border: "none", color: "#ef6b6b", borderRadius: "6px", padding: "10px 12px", cursor: "pointer", fontSize: "14px" }}
                          onClick={() => removeCandidate(posIdx, candIdx)}
                        >âœ•</button>
                      )}
                    </div>
                  ))}
                  <button
                    style={{ background: "none", border: "1px dashed rgba(201, 168, 76, 0.3)", color: "#c9a84c", borderRadius: "6px", padding: "8px", cursor: "pointer", fontSize: "12px", width: "100%", fontFamily: "'Georgia', serif", marginTop: "4px" }}
                    onClick={() => addCandidate(posIdx)}
                  >+ Add Candidate</button>
                </div>
              ))}

              <button
                style={{ ...styles.btn, ...styles.btnSecondary, marginBottom: "12px" }}
                onClick={addPosition}
              >+ Add New Position</button>

              <button
                style={{ ...styles.btn, ...styles.btnPrimary }}
                onClick={saveElectionConfig}
              >Save Configuration</button>
            </>
            )}
            </>
          )}

          {/* --- VOTERS TAB --- */}
          {adminTab === "voters" && (
            <>
              <div style={styles.cardHighlight}>
                <h3 style={{ fontSize: "14px", color: "#c9a84c", margin: "0 0 8px", letterSpacing: "1px" }}>
                  ADD VOTERS
                </h3>
                {/* FIX #1: Updated instructions to show supported formats */}
                <p style={{ fontSize: "12px", color: "#8899aa", margin: "0 0 16px", lineHeight: 1.6 }}>
                  Enter each alumnus on a new line in the format: <strong style={{ color: "#e8edf3" }}>Name - Phone Number</strong>
                  <br />
                  Phone numbers with hyphens, spaces, or brackets are all supported.
                  <br />
                  Examples: <em style={{ color: "#c9a84c" }}>Adebayo Kunle - 08034567890</em>
                  <br />
                  <em style={{ color: "#c9a84c" }}>Fatima Bello - 0706-123-4567</em>
                </p>

                <textarea
                  style={styles.textarea}
                  value={bulkInput}
                  onChange={e => setBulkInput(e.target.value)}
                  placeholder={"Adebayo Kunle - 08034567890\nFatima Bello - 0706-123-4567\nChukwu Emeka - (090) 9876 5432"}
                />

                <button
                  style={{ ...styles.btn, ...styles.btnPrimary, marginTop: "12px" }}
                  onClick={handleBulkAddVoters}
                  disabled={!bulkInput.trim()}
                >
                  Process & Add Voters
                </button>
              </div>

              <div style={styles.card}>
                <h3 style={{ fontSize: "14px", color: "#c9a84c", margin: "0 0 16px" }}>
                  Registered Voters ({voterRegistry.length})
                </h3>
                {voterRegistry.length === 0 ? (
                  <p style={{ fontSize: "13px", color: "#6b7d8e", textAlign: "center", padding: "20px 0" }}>
                    No voters registered yet. Add voters above.
                  </p>
                ) : (
                  <div style={{ maxHeight: "350px", overflowY: "auto" }}>
                    {voterRegistry.map((v, i) => (
                      <div key={i} style={{
                        display: "flex", justifyContent: "space-between", alignItems: "center",
                        padding: "10px 12px", borderBottom: "1px solid rgba(255,255,255,0.04)",
                        fontSize: "13px",
                      }}>
                        <div style={{ flex: 1, minWidth: 0 }}>
                          <div style={{ color: "#e8edf3", overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap" }}>{v.name}</div>
                          <div style={{ color: "#6b7d8e", fontSize: "11px" }}>{v.phone} â†’ <code style={{ color: "#c9a84c" }}>{v.code}</code></div>
                        </div>
                        <div style={{ display: "flex", alignItems: "center", gap: "6px", flexShrink: 0 }}>
                          <span style={{
                            ...styles.badge,
                            background: votedCodes.includes(v.code) ? "rgba(45,122,79,0.2)" : "rgba(255,255,255,0.05)",
                            color: votedCodes.includes(v.code) ? "#6bcf8e" : "#6b7d8e",
                            fontSize: "10px",
                          }}>
                            {votedCodes.includes(v.code) ? "VOTED" : "PENDING"}
                          </span>
                          {/* FIX #13: Remove individual voter (only if they haven't voted) */}
                          {!votedCodes.includes(v.code) && (
                            showRemoveVoterConfirm === i ? (
                              <div style={{ display: "flex", gap: "4px" }}>
                                <button onClick={() => removeVoter(i)} style={{ background: "rgba(220,50,50,0.3)", border: "none", color: "#fff", borderRadius: "4px", padding: "4px 8px", cursor: "pointer", fontSize: "10px", fontFamily: "'Georgia', serif" }}>Yes</button>
                                <button onClick={() => setShowRemoveVoterConfirm(null)} style={{ background: "rgba(255,255,255,0.1)", border: "none", color: "#8899aa", borderRadius: "4px", padding: "4px 8px", cursor: "pointer", fontSize: "10px", fontFamily: "'Georgia', serif" }}>No</button>
                              </div>
                            ) : (
                              <button
                                onClick={() => setShowRemoveVoterConfirm(i)}
                                style={{ background: "none", border: "none", color: "#6b7d8e", cursor: "pointer", padding: "4px", opacity: 0.6 }}
                              >
                                <TrashIcon />
                              </button>
                            )
                          )}
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            </>
          )}

          {/* --- CONTROL TAB --- */}
          {adminTab === "control" && (
            <>
              {/* Election status toggle */}
              <div style={styles.cardHighlight}>
                <h3 style={{ fontSize: "14px", color: "#c9a84c", margin: "0 0 8px" }}>Election Status</h3>
                <p style={{ fontSize: "12px", color: "#8899aa", margin: "0 0 16px" }}>
                  {electionActive
                    ? "The election is currently OPEN. Voters can cast their ballots."
                    : "The election is currently CLOSED. No votes can be cast."}
                </p>

                {/* FIX #12: In-app confirmation dialog for closing election */}
                {showCloseConfirm ? (
                  <div style={styles.confirmOverlay}>
                    <p style={{ color: "#e8edf3", fontSize: "14px", margin: "0 0 12px" }}>
                      Are you sure you want to <strong>close</strong> the election? No further votes will be accepted.
                    </p>
                    <div style={{ display: "flex", gap: "10px" }}>
                      <button style={{ ...styles.btn, ...styles.btnDanger, flex: 1 }} onClick={confirmCloseElection}>
                        Yes, Close Election
                      </button>
                      <button style={{ ...styles.btn, ...styles.btnSecondary, flex: 1 }} onClick={() => setShowCloseConfirm(false)}>
                        Cancel
                      </button>
                    </div>
                  </div>
                ) : (
                  <button
                    style={{ ...styles.btn, ...(electionActive ? styles.btnDanger : styles.btnSuccess) }}
                    onClick={toggleElection}
                  >
                    {electionActive ? "â¹ Close Election" : "â–¶ Open Election"}
                  </button>
                )}
              </div>

              {/* FIX #11: Results visibility toggle */}
              <div style={styles.card}>
                <h3 style={{ fontSize: "14px", color: "#c9a84c", margin: "0 0 8px" }}>Results Visibility</h3>
                <p style={{ fontSize: "12px", color: "#8899aa", margin: "0 0 16px" }}>
                  {resultsPublic
                    ? "Results are currently VISIBLE to all voters during the election."
                    : "Results are currently HIDDEN until the election closes."}
                </p>
                <button
                  style={{ ...styles.btn, ...styles.btnSecondary }}
                  onClick={toggleResultsVisibility}
                >
                  {resultsPublic ? "ðŸ™ˆ Hide Results During Voting" : "ðŸ‘ Show Results During Voting"}
                </button>
              </div>

              {/* Stats */}
              <div style={styles.card}>
                <h3 style={{ fontSize: "14px", color: "#c9a84c", margin: "0 0 16px" }}>Election Statistics</h3>
                <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: "12px" }}>
                  <div style={{ background: "rgba(0,0,0,0.2)", borderRadius: "8px", padding: "16px", textAlign: "center" }}>
                    <div style={{ fontSize: "28px", fontWeight: "700", color: "#c9a84c" }}>{totalRegistered}</div>
                    <div style={{ fontSize: "10px", color: "#6b7d8e", textTransform: "uppercase", letterSpacing: "1px" }}>Registered</div>
                  </div>
                  <div style={{ background: "rgba(0,0,0,0.2)", borderRadius: "8px", padding: "16px", textAlign: "center" }}>
                    <div style={{ fontSize: "28px", fontWeight: "700", color: "#c9a84c" }}>{totalVotesCast}</div>
                    <div style={{ fontSize: "10px", color: "#6b7d8e", textTransform: "uppercase", letterSpacing: "1px" }}>Voted</div>
                  </div>
                  <div style={{ background: "rgba(0,0,0,0.2)", borderRadius: "8px", padding: "16px", textAlign: "center" }}>
                    <div style={{ fontSize: "28px", fontWeight: "700", color: "#c9a84c" }}>{totalRegistered - totalVotesCast}</div>
                    <div style={{ fontSize: "10px", color: "#6b7d8e", textTransform: "uppercase", letterSpacing: "1px" }}>Remaining</div>
                  </div>
                  <div style={{ background: "rgba(0,0,0,0.2)", borderRadius: "8px", padding: "16px", textAlign: "center" }}>
                    <div style={{ fontSize: "28px", fontWeight: "700", color: "#c9a84c" }}>
                      {totalRegistered > 0 ? Math.round((totalVotesCast / totalRegistered) * 100) : 0}%
                    </div>
                    <div style={{ fontSize: "10px", color: "#6b7d8e", textTransform: "uppercase", letterSpacing: "1px" }}>Turnout</div>
                  </div>
                </div>
              </div>

              {/* FIX #5: Change admin password */}
              <div style={styles.card}>
                <h3 style={{ fontSize: "14px", color: "#c9a84c", margin: "0 0 8px" }}>Change Admin Password</h3>
                <p style={{ fontSize: "12px", color: "#8899aa", margin: "0 0 16px" }}>
                  Set a new password for the admin panel. Minimum 6 characters.
                </p>
                <div style={{ display: "flex", gap: "8px" }}>
                  <input
                    type="password"
                    style={{ ...styles.input, flex: 1, fontSize: "14px", padding: "10px 12px" }}
                    value={newAdminPassword}
                    onChange={e => setNewAdminPassword(e.target.value)}
                    placeholder="New password (min 6 chars)"
                  />
                  <button
                    style={{ ...styles.btn, ...styles.btnPrimary, width: "auto", padding: "10px 16px", fontSize: "13px" }}
                    onClick={handleChangePassword}
                    disabled={newAdminPassword.length < 6}
                  >
                    Change
                  </button>
                </div>
              </div>

              {/* FIX #3: In-app reset confirmation (no confirm() call) */}
              <div style={{ ...styles.card, borderColor: "rgba(220, 50, 50, 0.2)" }}>
                <h3 style={{ fontSize: "14px", color: "#ef6b6b", margin: "0 0 8px" }}>Danger Zone</h3>
                <p style={{ fontSize: "12px", color: "#8899aa", margin: "0 0 16px" }}>
                  Reset the entire election. This permanently deletes ALL votes, voter registrations, and data.
                </p>
                {showResetConfirm ? (
                  <div style={styles.confirmOverlay}>
                    <p style={{ color: "#ef6b6b", fontWeight: "700", fontSize: "14px", margin: "0 0 8px" }}>
                      âš ï¸ FINAL WARNING
                    </p>
                    <p style={{ color: "#8899aa", fontSize: "12px", margin: "0 0 16px" }}>
                      This will DELETE all {totalVotesCast} votes, {totalRegistered} voter registrations, and all election data. This cannot be undone.
                    </p>
                    <div style={{ display: "flex", gap: "10px" }}>
                      <button style={{ ...styles.btn, ...styles.btnDanger, flex: 1 }} onClick={resetElection}>
                        Yes, Delete Everything
                      </button>
                      <button style={{ ...styles.btn, ...styles.btnSecondary, flex: 1 }} onClick={() => setShowResetConfirm(false)}>
                        Cancel
                      </button>
                    </div>
                  </div>
                ) : (
                  <button style={{ ...styles.btn, ...styles.btnDanger }} onClick={() => setShowResetConfirm(true)}>
                    Reset Entire Election
                  </button>
                )}
              </div>
            </>
          )}
        </div>
      </div>
    );
  }

  // ============================================================
  // SCREEN: VOTER LOGIN
  // ============================================================
  if (screen === "voter_login") {
    return (
      <div style={styles.app}>
        <div style={styles.header}>
          <h1 style={styles.headerTitle}>Voter Verification</h1>
          <p style={styles.headerSub}>Authenticate to Vote</p>
        </div>
        <div style={styles.container}>
          <div style={styles.cardHighlight}>
            <div style={{ textAlign: "center", marginBottom: "24px" }}>
              <img src={IHCHS_LOGO} alt="IHCHS Crest" style={{ width: "52px", height: "52px", objectFit: "contain", marginBottom: "12px" }} />
              <h3 style={{ fontSize: "16px", color: "#e8edf3", margin: "0 0 8px" }}>Enter Your Verification Code</h3>
              <p style={{ fontSize: "12px", color: "#8899aa", margin: 0, lineHeight: 1.7 }}>
                Your code is the <strong style={{ color: "#c9a84c" }}>first 3 digits</strong> and <strong style={{ color: "#c9a84c" }}>last 4 digits</strong> of the phone number you registered with the alumni secretariat.
              </p>
              <p style={{ fontSize: "12px", color: "#6b7d8e", margin: "8px 0 0", fontStyle: "italic" }}>
                Example: If your number is 0803-456-7890, your code is <strong style={{ color: "#e8edf3" }}>0807890</strong>
              </p>
            </div>

            <StatusBanner />

            <div style={{ marginBottom: "16px" }}>
              <label style={styles.label}>Verification Code</label>
              <input
                type="tel"
                style={{ ...styles.input, fontSize: "22px", textAlign: "center", letterSpacing: "6px", fontWeight: "700" }}
                value={voterCode}
                onChange={e => setVoterCode(e.target.value.replace(/\D/g, "").slice(0, 7))}
                onKeyDown={e => e.key === "Enter" && handleVoterLogin()}
                placeholder="0000000"
                maxLength={7}
              />
            </div>

            <button
              style={{ ...styles.btn, ...styles.btnPrimary, marginBottom: "8px", opacity: voterCode.length < 7 ? 0.4 : 1 }}
              onClick={handleVoterLogin}
              disabled={voterCode.length < 7}
            >
              <LockIcon /> Verify & Proceed
            </button>
          </div>

          <button
            style={{ ...styles.btn, ...styles.btnSecondary }}
            onClick={() => navigateTo("home")}
          >
            â† Back to Home
          </button>
        </div>
      </div>
    );
  }

  // ============================================================
  // SCREEN: ALREADY VOTED
  // ============================================================
  if (screen === "already_voted") {
    return (
      <div style={styles.app}>
        <div style={styles.header}>
          <h1 style={styles.headerTitle}>Vote Recorded</h1>
          <p style={styles.headerSub}>One Person, One Vote</p>
        </div>
        <div style={styles.container}>
          <div style={{ ...styles.card, textAlign: "center", padding: "40px 24px" }}>
            <div style={{ fontSize: "48px", marginBottom: "16px" }}>âœ“</div>
            <h2 style={{ fontSize: "20px", color: "#c9a84c", margin: "0 0 12px" }}>Already Voted</h2>
            <p style={{ fontSize: "14px", color: "#8899aa", margin: "0 0 8px", lineHeight: 1.6 }}>
              Dear <strong style={{ color: "#e8edf3" }}>{currentVoter?.name}</strong>, your vote has already been recorded in this election.
            </p>
            <p style={{ fontSize: "12px", color: "#6b7d8e" }}>
              Each verified alumni member can only vote once to ensure a fair election.
            </p>
          </div>

          {(resultsPublic || !electionActive) && (
            <button style={{ ...styles.btn, ...styles.btnSecondary, marginBottom: "12px" }} onClick={() => navigateTo("results")}>
              <ChartIcon /> View Results
            </button>
          )}
          <button style={{ ...styles.btn, ...styles.btnSecondary }} onClick={() => navigateTo("home")}>
            â† Back to Home
          </button>
        </div>
      </div>
    );
  }

  // ============================================================
  // SCREEN: BALLOT
  // ============================================================
  if (screen === "ballot") {
    const positions = electionData?.positions || [];
    const currentPosition = positions[currentStep];
    const progress = ((currentStep) / positions.length) * 100;
    const isLastStep = currentStep === positions.length - 1;

    // Review screen (after last position)
    if (currentStep >= positions.length) {
      return (
        <div style={styles.app}>
          <div style={styles.header}>
            <h1 style={styles.headerTitle}>Review Your Ballot</h1>
            <p style={styles.headerSub}>Confirm Your Selections</p>
          </div>
          <div style={styles.container}>
            <div style={styles.progressBar}>
              <div style={styles.progressFill(100)} />
            </div>

            <div style={styles.cardHighlight}>
              <p style={{ fontSize: "13px", color: "#8899aa", margin: "0 0 20px", textAlign: "center" }}>
                Please review your selections carefully. Once submitted, your vote <strong style={{ color: "#ef6b6b" }}>cannot be changed</strong>.
              </p>

              {positions.map(pos => {
                const selectedId = selections[pos.id];
                let displayName = "â€”";
                let displayColor = "#6b7d8e";
                let displayStyle = "italic";

                if (selectedId === "abstain") {
                  displayName = "â€” Abstained â€”";
                } else if (selectedId === "reject") {
                  displayName = `NO â€” Rejected ${pos.candidates[0]?.name}`;
                  displayColor = "#ef6b6b";
                } else if (pos.candidates.length === 1 && selectedId === pos.candidates[0]?.id) {
                  displayName = `YES â€” Endorsed ${pos.candidates[0].name}`;
                  displayColor = "#6bcf8e";
                  displayStyle = "normal";
                } else {
                  const selectedCand = pos.candidates.find(c => c.id === selectedId);
                  displayName = selectedCand?.name || "â€”";
                  displayColor = "#e8edf3";
                  displayStyle = "normal";
                }

                return (
                  <div key={pos.id} style={{ padding: "12px 0", borderBottom: "1px solid rgba(255,255,255,0.05)" }}>
                    <div style={{ fontSize: "11px", color: "#6b7d8e", textTransform: "uppercase", letterSpacing: "1px" }}>{pos.title}</div>
                    <div style={{
                      fontSize: "15px",
                      color: displayColor,
                      fontWeight: "600",
                      marginTop: "4px",
                      fontStyle: displayStyle,
                    }}>
                      {displayName}
                    </div>
                  </div>
                );
              })}
            </div>

            {showConfirmDialog ? (
              <div style={styles.confirmOverlay}>
                <h3 style={{ color: "#c9a84c", margin: "0 0 12px", fontSize: "16px" }}>Final Confirmation</h3>
                <p style={{ fontSize: "13px", color: "#8899aa", margin: "0 0 20px" }}>
                  Are you absolutely sure? This action is permanent and cannot be undone.
                </p>
                <button
                  style={{ ...styles.btn, ...styles.btnPrimary, marginBottom: "10px" }}
                  onClick={castVote}
                  disabled={loading}
                >
                  {loading ? "Submitting..." : "âœ“ YES, SUBMIT MY VOTE"}
                </button>
                <button
                  style={{ ...styles.btn, ...styles.btnSecondary }}
                  onClick={() => setShowConfirmDialog(false)}
                >
                  Cancel
                </button>
              </div>
            ) : (
              <>
                <button
                  style={{ ...styles.btn, ...styles.btnPrimary, marginBottom: "10px" }}
                  onClick={() => setShowConfirmDialog(true)}
                >
                  <VoteIcon /> SUBMIT BALLOT
                </button>
                <button
                  style={{ ...styles.btn, ...styles.btnSecondary }}
                  onClick={() => setCurrentStep(positions.length - 1)}
                >
                  â† Go Back
                </button>
              </>
            )}
          </div>
        </div>
      );
    }

    return (
      <div style={styles.app}>
        <div style={styles.header}>
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
            <div>
              <h1 style={{ ...styles.headerTitle, fontSize: "14px" }}>Ballot</h1>
              <p style={{ ...styles.headerSub, marginTop: "2px" }}>Step {currentStep + 1} of {positions.length}</p>
            </div>
            <span style={{ fontSize: "12px", color: "#8899aa" }}>
              {currentVoter?.name}
            </span>
          </div>
        </div>
        <div style={styles.container}>
          <div style={styles.progressBar}>
            <div style={styles.progressFill(progress)} />
          </div>

          <div style={styles.cardHighlight}>
            <h2 style={{ fontSize: "18px", color: "#c9a84c", margin: "0 0 4px", textAlign: "center" }}>
              {currentPosition.title}
            </h2>

            {/* Different instructions for contested vs unopposed positions */}
            {currentPosition.candidates.length === 1 ? (
              <>
                <p style={{ fontSize: "12px", color: "#6b7d8e", textAlign: "center", margin: "0 0 8px" }}>
                  Unopposed candidate
                </p>
                <div style={{
                  textAlign: "center", padding: "16px", marginBottom: "16px",
                  background: "rgba(255,255,255,0.03)", borderRadius: "8px",
                  border: "1px solid rgba(201, 168, 76, 0.1)"
                }}>
                  <div style={{ fontSize: "17px", fontWeight: "700", color: "#e8edf3" }}>
                    {currentPosition.candidates[0].name}
                  </div>
                  <div style={{ fontSize: "11px", color: "#6b7d8e", marginTop: "4px" }}>
                    Do you endorse this candidate?
                  </div>
                </div>

                {/* YES - Endorse */}
                <div
                  style={styles.candidateOption(selections[currentPosition.id] === currentPosition.candidates[0].id)}
                  onClick={() => setSelections({ ...selections, [currentPosition.id]: currentPosition.candidates[0].id })}
                >
                  <div style={styles.radio(selections[currentPosition.id] === currentPosition.candidates[0].id)}>
                    {selections[currentPosition.id] === currentPosition.candidates[0].id && (
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="#0a1628" stroke="#0a1628" strokeWidth="3">
                        <polyline points="20 6 9 17 4 12" />
                      </svg>
                    )}
                  </div>
                  <div>
                    <div style={{ fontSize: "15px", fontWeight: "600", color: selections[currentPosition.id] === currentPosition.candidates[0].id ? "#6bcf8e" : "#e8edf3" }}>
                      YES â€” Endorse
                    </div>
                  </div>
                </div>

                {/* NO - Reject */}
                <div
                  style={styles.candidateOption(selections[currentPosition.id] === "reject")}
                  onClick={() => setSelections({ ...selections, [currentPosition.id]: "reject" })}
                >
                  <div style={{
                    ...styles.radio(selections[currentPosition.id] === "reject"),
                    borderColor: selections[currentPosition.id] === "reject" ? "#ef6b6b" : "rgba(255,255,255,0.2)",
                    background: selections[currentPosition.id] === "reject" ? "#ef6b6b" : "transparent",
                  }}>
                    {selections[currentPosition.id] === "reject" && (
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="#0a1628" stroke="#0a1628" strokeWidth="3">
                        <polyline points="20 6 9 17 4 12" />
                      </svg>
                    )}
                  </div>
                  <div>
                    <div style={{ fontSize: "15px", fontWeight: "600", color: selections[currentPosition.id] === "reject" ? "#ef6b6b" : "#e8edf3" }}>
                      NO â€” Reject
                    </div>
                  </div>
                </div>
              </>
            ) : (
              <>
                <p style={{ fontSize: "12px", color: "#6b7d8e", textAlign: "center", margin: "0 0 24px" }}>
                  Select one candidate or abstain
                </p>

                {currentPosition.candidates.map(cand => {
                  const isSelected = selections[currentPosition.id] === cand.id;
                  return (
                    <div
                      key={cand.id}
                      style={styles.candidateOption(isSelected)}
                      onClick={() => setSelections({ ...selections, [currentPosition.id]: cand.id })}
                    >
                      <div style={styles.radio(isSelected)}>
                        {isSelected && (
                          <svg width="12" height="12" viewBox="0 0 24 24" fill="#0a1628" stroke="#0a1628" strokeWidth="3">
                            <polyline points="20 6 9 17 4 12" />
                          </svg>
                        )}
                      </div>
                      <div>
                        <div style={{ fontSize: "15px", fontWeight: "600", color: isSelected ? "#c9a84c" : "#e8edf3" }}>
                          {cand.name || "(Unnamed Candidate)"}
                        </div>
                        {cand.motto && (
                          <div style={{ fontSize: "11px", color: "#6b7d8e", marginTop: "2px", fontStyle: "italic" }}>
                            "{cand.motto}"
                          </div>
                        )}
                      </div>
                    </div>
                  );
                })}
              </>
            )}

            {/* Abstain option */}
            <div
              style={styles.abstainOption(selections[currentPosition.id] === "abstain")}
              onClick={() => setSelections({ ...selections, [currentPosition.id]: "abstain" })}
            >
              <div style={{
                ...styles.radio(selections[currentPosition.id] === "abstain"),
                borderColor: selections[currentPosition.id] === "abstain" ? "#6b7d8e" : "rgba(255,255,255,0.15)",
                background: selections[currentPosition.id] === "abstain" ? "#6b7d8e" : "transparent",
              }}>
                {selections[currentPosition.id] === "abstain" && (
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="#0a1628" stroke="#0a1628" strokeWidth="3">
                    <polyline points="20 6 9 17 4 12" />
                  </svg>
                )}
              </div>
              <div style={{ fontSize: "13px", color: "#6b7d8e", fontStyle: "italic" }}>
                Abstain (skip this position)
              </div>
            </div>
          </div>

          <div style={{ display: "flex", gap: "10px" }}>
            {currentStep > 0 && (
              <button
                style={{ ...styles.btn, ...styles.btnSecondary, flex: 1 }}
                onClick={() => setCurrentStep(currentStep - 1)}
              >
                â† Previous
              </button>
            )}
            <button
              style={{
                ...styles.btn,
                ...styles.btnPrimary,
                flex: 1,
                opacity: selections[currentPosition.id] ? 1 : 0.4,
              }}
              onClick={() => {
                if (selections[currentPosition.id]) {
                  setCurrentStep(currentStep + 1);
                }
              }}
              disabled={!selections[currentPosition.id]}
            >
              {isLastStep ? "Review Ballot â†’" : "Next â†’"}
            </button>
          </div>
        </div>
      </div>
    );
  }

  // ============================================================
  // SCREEN: CONFIRMATION
  // ============================================================
  if (screen === "confirmation") {
    return (
      <div style={styles.app}>
        <div style={styles.header}>
          <h1 style={styles.headerTitle}>Vote Confirmed</h1>
          <p style={styles.headerSub}>Thank You</p>
        </div>
        <div style={styles.container}>
          <div style={{ ...styles.cardHighlight, textAlign: "center", padding: "40px 24px" }}>
            <div style={{
              width: "72px", height: "72px", borderRadius: "50%",
              background: "linear-gradient(135deg, rgba(45, 122, 79, 0.3), rgba(45, 122, 79, 0.1))",
              border: "2px solid rgba(45, 122, 79, 0.5)",
              display: "flex", alignItems: "center", justifyContent: "center",
              margin: "0 auto 20px",
              color: "#6bcf8e",
            }}>
              <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5">
                <polyline points="20 6 9 17 4 12" />
              </svg>
            </div>
            <h2 style={{ fontSize: "22px", color: "#6bcf8e", margin: "0 0 8px" }}>Vote Successfully Cast!</h2>
            <p style={{ fontSize: "14px", color: "#8899aa", margin: "0 0 4px" }}>
              Thank you, <strong style={{ color: "#e8edf3" }}>{currentVoter?.name}</strong>.
            </p>
            <p style={{ fontSize: "12px", color: "#6b7d8e", margin: "0 0 20px" }}>
              Your ballot has been securely recorded. Your verification code has been marked as used.
            </p>

            <div style={{
              background: "rgba(0,0,0,0.2)", borderRadius: "8px", padding: "12px",
              fontSize: "11px", color: "#6b7d8e", lineHeight: 1.6,
            }}>
              Vote Reference: #{simpleHash(currentVoter?.code + Date.now())}
              <br />
              Recorded: {new Date().toLocaleString()}
            </div>
          </div>

          {(resultsPublic || !electionActive) && (
            <button style={{ ...styles.btn, ...styles.btnSecondary, marginBottom: "12px" }} onClick={() => navigateTo("results")}>
              <ChartIcon /> View Live Results
            </button>
          )}
          <button style={{ ...styles.btn, ...styles.btnSecondary }} onClick={() => { navigateTo("home"); setCurrentVoter(null); }}>
            â† Back to Home
          </button>
        </div>
      </div>
    );
  }

  // ============================================================
  // SCREEN: RESULTS
  // ============================================================
  if (screen === "results") {
    const positions = electionData?.positions || [];

    return (
      <div style={styles.app}>
        <div style={styles.header}>
          <h1 style={styles.headerTitle}>Election Results</h1>
          <p style={styles.headerSub}>{totalVotesCast} vote{totalVotesCast !== 1 ? "s" : ""} cast</p>
        </div>
        <div style={styles.container}>
          <div style={{
            display: "flex", justifyContent: "space-between", alignItems: "center",
            padding: "14px 18px", background: "rgba(201, 168, 76, 0.08)",
            border: "1px solid rgba(201, 168, 76, 0.15)", borderRadius: "10px",
            marginBottom: "20px",
          }}>
            <div>
              <div style={{ fontSize: "11px", color: "#6b7d8e", textTransform: "uppercase", letterSpacing: "1px" }}>Voter Turnout</div>
              <div style={{ fontSize: "20px", fontWeight: "700", color: "#c9a84c" }}>
                {totalRegistered > 0 ? Math.round((totalVotesCast / totalRegistered) * 100) : 0}%
              </div>
            </div>
            <div style={{ textAlign: "right" }}>
              <div style={{ fontSize: "13px", color: "#e8edf3" }}>{totalVotesCast} / {totalRegistered}</div>
              <div style={{ fontSize: "11px", color: "#6b7d8e" }}>votes / registered</div>
            </div>
          </div>

          {totalVotesCast === 0 ? (
            <div style={{ ...styles.card, textAlign: "center", padding: "40px 24px" }}>
              <p style={{ color: "#6b7d8e", fontSize: "14px" }}>No votes have been cast yet.</p>
            </div>
          ) : (
            positions.map(pos => {
              const posTotalVotes = getPositionTotalVotes(pos.id);
              const rejectCount = votes[pos.id]?.["__reject"] || 0;
              const isUnopposed = pos.candidates.length === 1;

              // For unopposed: show YES (endorsements) vs NO (rejections)
              if (isUnopposed) {
                const yesCount = getVoteCount(pos.id, pos.candidates[0].id);
                const totalYesNo = yesCount + rejectCount;
                const yesPct = totalYesNo > 0 ? (yesCount / totalYesNo) * 100 : 0;
                const noPct = totalYesNo > 0 ? (rejectCount / totalYesNo) * 100 : 0;
                const endorsed = yesCount >= rejectCount;

                return (
                  <div key={pos.id} style={{ ...styles.card, padding: "20px" }}>
                    <h3 style={{ fontSize: "14px", color: "#c9a84c", margin: "0 0 4px", letterSpacing: "1px", textTransform: "uppercase" }}>
                      {pos.title}
                    </h3>
                    <div style={{ fontSize: "13px", color: "#8899aa", margin: "0 0 16px" }}>
                      {pos.candidates[0].name} <span style={{ fontSize: "10px", color: "#6b7d8e" }}>(unopposed)</span>
                    </div>

                    {/* YES bar */}
                    <div style={{ marginBottom: "10px" }}>
                      <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
                        <span style={{ fontSize: "14px", color: endorsed ? "#6bcf8e" : "#8899aa", fontWeight: endorsed ? "600" : "400" }}>
                          YES â€” Endorsed {endorsed && yesCount > 0 && <span style={{ color: "#c9a84c", fontSize: "11px", marginLeft: "4px" }}>âœ“</span>}
                        </span>
                        <span style={{ fontSize: "13px", color: endorsed ? "#6bcf8e" : "#6b7d8e", fontWeight: "600" }}>
                          {yesCount} ({Math.round(yesPct)}%)
                        </span>
                      </div>
                      <div style={styles.resultBar()}>
                        <div style={{
                          height: "100%", width: `${Math.max(yesPct, yesCount > 0 ? 2 : 0)}%`,
                          background: endorsed ? "linear-gradient(90deg, #2d7a4f, #4caf50)" : "linear-gradient(90deg, rgba(255,255,255,0.15), rgba(255,255,255,0.08))",
                          borderRadius: "6px", transition: "width 0.6s ease",
                          display: "flex", alignItems: "center", paddingLeft: "10px",
                        }}>
                          <span style={{ fontSize: "10px", color: endorsed ? "#fff" : "#8899aa", fontWeight: "700" }}>
                            {yesPct > 10 ? `${Math.round(yesPct)}%` : ""}
                          </span>
                        </div>
                      </div>
                    </div>

                    {/* NO bar */}
                    <div style={{ marginBottom: "10px" }}>
                      <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
                        <span style={{ fontSize: "14px", color: !endorsed && rejectCount > 0 ? "#ef6b6b" : "#8899aa", fontWeight: !endorsed && rejectCount > 0 ? "600" : "400" }}>
                          NO â€” Rejected
                        </span>
                        <span style={{ fontSize: "13px", color: !endorsed && rejectCount > 0 ? "#ef6b6b" : "#6b7d8e", fontWeight: "600" }}>
                          {rejectCount} ({Math.round(noPct)}%)
                        </span>
                      </div>
                      <div style={styles.resultBar()}>
                        <div style={{
                          height: "100%", width: `${Math.max(noPct, rejectCount > 0 ? 2 : 0)}%`,
                          background: !endorsed && rejectCount > 0 ? "linear-gradient(90deg, #c0392b, #e74c3c)" : "linear-gradient(90deg, rgba(255,255,255,0.15), rgba(255,255,255,0.08))",
                          borderRadius: "6px", transition: "width 0.6s ease",
                          display: "flex", alignItems: "center", paddingLeft: "10px",
                        }}>
                          <span style={{ fontSize: "10px", color: "#fff", fontWeight: "700" }}>
                            {noPct > 10 ? `${Math.round(noPct)}%` : ""}
                          </span>
                        </div>
                      </div>
                    </div>

                    {/* Abstained count */}
                    {totalYesNo < totalVotesCast && totalVotesCast > 0 && (
                      <div style={{ fontSize: "11px", color: "#6b7d8e", fontStyle: "italic", marginTop: "4px" }}>
                        {totalVotesCast - totalYesNo} voter(s) abstained
                      </div>
                    )}
                  </div>
                );
              }

              // For contested positions: show candidate comparison
              let maxVotes = 0;
              pos.candidates.forEach(c => {
                const cv = getVoteCount(pos.id, c.id);
                if (cv > maxVotes) maxVotes = cv;
              });

              return (
                <div key={pos.id} style={{ ...styles.card, padding: "20px" }}>
                  <h3 style={{ fontSize: "14px", color: "#c9a84c", margin: "0 0 16px", letterSpacing: "1px", textTransform: "uppercase" }}>
                    {pos.title}
                  </h3>
                  {pos.candidates.map(cand => {
                    const cv = getVoteCount(pos.id, cand.id);
                    const pct = posTotalVotes > 0 ? (cv / posTotalVotes) * 100 : 0;
                    const isLeading = cv === maxVotes && cv > 0;

                    return (
                      <div key={cand.id} style={{ marginBottom: "14px" }}>
                        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
                          <span style={{ fontSize: "14px", color: isLeading ? "#e8edf3" : "#8899aa", fontWeight: isLeading ? "600" : "400" }}>
                            {cand.name || "(Unnamed)"}
                            {isLeading && cv > 0 && <span style={{ color: "#c9a84c", fontSize: "11px", marginLeft: "6px" }}>â˜… LEADING</span>}
                          </span>
                          <span style={{ fontSize: "13px", color: isLeading ? "#c9a84c" : "#6b7d8e", fontWeight: "600" }}>
                            {cv} ({Math.round(pct)}%)
                          </span>
                        </div>
                        <div style={styles.resultBar()}>
                          <div style={styles.resultFill(pct, isLeading)}>
                            <span style={{ fontSize: "10px", color: isLeading ? "#0a1628" : "#8899aa", fontWeight: "700" }}>
                              {pct > 10 ? `${Math.round(pct)}%` : ""}
                            </span>
                          </div>
                        </div>
                      </div>
                    );
                  })}
                  {posTotalVotes < totalVotesCast && totalVotesCast > 0 && (
                    <div style={{ fontSize: "11px", color: "#6b7d8e", fontStyle: "italic", marginTop: "4px" }}>
                      {totalVotesCast - posTotalVotes} voter(s) abstained from this position
                    </div>
                  )}
                </div>
              );
            })
          )}

          <button
            style={{ ...styles.btn, ...styles.btnSecondary }}
            onClick={() => { navigateTo("home"); setCurrentVoter(null); }}
          >
            â† Back to Home
          </button>
        </div>
      </div>
    );
  }

  return null;
}
